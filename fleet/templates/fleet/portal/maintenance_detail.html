{% extends 'fleet/portal/base.html' %}

{% block title %}صيانة - {{ maintenance.vehicle.license_plate }}{% endblock %}

{% block content %}
<div class="mb-6">
    <a href="{% url 'fleet:maintenance_list' %}" class="btn btn-ghost mb-4">
        <i class="fas fa-arrow-right"></i> العودة للقائمة
    </a>
    <h1 class="text-4xl font-bold">
        <i class="fas fa-wrench"></i> صيانة - {{ maintenance.vehicle.license_plate }}
    </h1>
</div>

<div class="card bg-base-100 shadow-xl mb-6">
    <div class="card-body">
        <h2 class="card-title text-2xl mb-4">
            <i class="fas fa-info-circle"></i> معلومات الصيانة
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <p class="mb-2">
                    <strong>المركبة:</strong>
                    <a href="{% url 'fleet:vehicle_detail' maintenance.vehicle.pk %}" class="link link-primary">
                        {{ maintenance.vehicle.license_plate }} - {{ maintenance.vehicle.model }}
                    </a>
                </p>
                <p class="mb-2"><strong>نوع الصيانة:</strong> {{ maintenance.service_type }}</p>
                <p class="mb-2"><strong>تاريخ الصيانة:</strong> {{ maintenance.service_date }}</p>
                <p class="mb-2"><strong>مقدم الخدمة:</strong> {{ maintenance.service_provider }}</p>
            </div>
            <div>
                <p class="mb-2"><strong>قراءة عداد المسافة:</strong> {{ maintenance.odometer_km }} كم</p>
                <p class="mb-2"><strong>التكلفة الكلية:</strong> {{ maintenance.service_total_cost }} جنيه</p>
                {% if maintenance.downtime_hrs %}
                <p class="mb-2"><strong>وقت التوقف:</strong> {{ maintenance.downtime_hrs }} ساعة</p>
                {% endif %}
                {% if maintenance.next_service_due %}
                <p class="mb-2"><strong>الصيانة القادمة:</strong> {{ maintenance.next_service_due }}</p>
                {% endif %}
            </div>
        </div>
        
        {% if maintenance.notes %}
        <div class="mt-4">
            <strong>ملاحظات:</strong>
            <p class="mt-2 p-4 bg-base-200 rounded">{{ maintenance.notes }}</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="card bg-base-100 shadow-xl mb-6">
    <div class="card-body">
        <h2 class="card-title text-2xl mb-4">
            <i class="fas fa-cog"></i> الأسبيرات المستخدمة
        </h2>
        {% if parts %}
        <div class="overflow-x-auto">
            <table class="table table-zebra">
                <thead>
                    <tr>
                        <th>الاسبير</th>
                        <th>الكمية</th>
                        <th>سعر الوحدة</th>
                        <th>الإجمالي</th>
                        <th>ملاحظات</th>
                    </tr>
                </thead>
                <tbody>
                    {% for part in parts %}
                    <tr>
                        <td>{{ part.part }}</td>
                        <td>{{ part.quantity }}</td>
                        <td>{{ part.unit_price }} جنيه</td>
                        <td>{{ part.total_price }} جنيه</td>
                        <td>{{ part.notes|default:"-" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-gray-500">لا توجد أسبيرات مسجلة</p>
        {% endif %}
    </div>
</div>
{% endblock %}
