# Generated by Django 5.1.7 on 2025-04-24 17:18

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import hse_companies.models.incidents
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('company_profile', '0118_alter_apptechnicalfinancialreport_report_comments'),
        ('hse_companies', '0008_apphsecorrectiveactionfeedback'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='apphsecorrectiveaction',
            name='created_at',
            field=models.DateTimeField(auto_now_add=True, default=django.utils.timezone.now, verbose_name='created_at'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='apphsecorrectiveaction',
            name='created_by',
            field=models.ForeignKey(default=1, editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='created_by'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='apphsecorrectiveaction',
            name='updated_at',
            field=models.DateTimeField(auto_now=True, verbose_name='updated_at'),
        ),
        migrations.AddField(
            model_name='apphsecorrectiveaction',
            name='updated_by',
            field=models.ForeignKey(default=1, editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='updated_by'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='apphsecorrectiveactionfeedback',
            name='created_at',
            field=models.DateTimeField(auto_now_add=True, default=django.utils.timezone.now, verbose_name='created_at'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='apphsecorrectiveactionfeedback',
            name='created_by',
            field=models.ForeignKey(default=1, editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='created_by'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='apphsecorrectiveactionfeedback',
            name='updated_at',
            field=models.DateTimeField(auto_now=True, verbose_name='updated_at'),
        ),
        migrations.AddField(
            model_name='apphsecorrectiveactionfeedback',
            name='updated_by',
            field=models.ForeignKey(default=1, editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='updated_by'),
            preserve_default=False,
        ),
        migrations.CreateModel(
            name='IncidentAnalysis',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='created_at')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='updated_at')),
                ('sequence_of_events', models.TextField(help_text='Describe the sequence of events leading to the incident', verbose_name='تتابع الاحداث Sequence of Events')),
                ('unsafe_acts', models.TextField(blank=True, help_text='مثلاً. السرعة الزائدة، تجاهل علامات السلامة، ... إلخ E.g. Speeding, Ignoring Safety Signs, etc.', null=True, verbose_name='افعال/تصرفات غير آمنة Unsafe Acts')),
                ('unsafe_conditions', models.TextField(blank=True, help_text='طريق رطب، أداة يدوية معابة/ لها عطل، ... إلخ E.g. Wet Road, defected tools, etc.', null=True, verbose_name='ظروف غير عمل غير آمنة Unsafe Conditions')),
                ('repeated_incident', models.BooleanField(default=False, verbose_name='هل هذا حادث مكرر؟ repeated incident?')),
                ('repeated_incident_reason', models.TextField(blank=True, null=True, verbose_name='في حالة الاجابة بنعم يرجى ذكر إجراءات التحكم الغير مجدية بالحادث السابق If yes, list the control failures at the previous ')),
                ('created_by', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='created_by')),
                ('updated_by', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='updated_by')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ContributingFactor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('factor_type', models.SmallIntegerField(choices=[(1, 'بيئة العمل Work environment'), (2, ' الادوات، الالات او المنشاة Tools, equipment or plant'), (3, 'اجراءات العمل/القواعد Work procedures/rules'), (4, ' التواصل/المعلومات Communication/information'), (5, 'المناولة اليدوية Manual handling'), (6, 'النظافة والترتيب Housekeeping'), (7, 'اجهزة السلامة/التحذير Warning/safety devices'), (8, 'التدريب/مستوى المهارات Training/skill level'), (9, 'عوامل شخصية Personal factors'), (10, 'عوامل خارجية External factors'), (11, 'ادوات السلامة الشخصية Personal protective equipment'), (12, 'اخرى Other')], verbose_name='الاسباب المساهمة في الحادث Contributing Causes')),
                ('description', models.TextField(help_text='Explain how this factor contributed to the incident', verbose_name='وصف الاسباب المساهمة في الحادث contributing factors description')),
                ('incident_analysis', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contributing_factors', to='hse_companies.incidentanalysis')),
            ],
        ),
        migrations.CreateModel(
            name='IncidentInfo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='created_at')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='updated_at')),
                ('incident_category', models.SmallIntegerField(choices=[('OCC_HEALTH', 'Occupational Health'), ('SAFETY', 'Safety'), ('ENVIRONMENT', 'Environment')], verbose_name='فئة الحادث Incident Category')),
                ('incident_type', models.SmallIntegerField(choices=[(1, 'إصابة خطيرة – تطلبت المكوث Serious Injury - Hospitalisation'), (2, 'إصابة متوسطة - تطلبت عناية طبية  Moderate Injury - Medical Treated'), (3, 'إصابة بسيطة - تطلبت إسعافات أولية Minor Injury - Required First Aid'), (4, ' ضرر بالممتلكات Property Damage'), (5, 'وفاة Fatality'), (6, 'مرض مهني Occupational Illness'), (7, 'تلوث بيئي Environmental Contamination'), (8, 'حريق/إنفجار Fire/Explosions'), (9, 'تسرب مواد / كيماويات خطرة Hazardous Chemicals / Substances'), (10, 'حادث مركبة / آلية Vehicle / Equipment Incident'), (11, 'بادرة حادث Near Miss'), (12, 'اخرى Other')], verbose_name='نوع الحادث Incident Type')),
                ('other_type_details', models.CharField(blank=True, max_length=200, null=True, verbose_name='في حال اخرى حدد If other specify')),
                ('classification', models.SmallIntegerField(choices=[(1, 'جسيم Major'), (2, 'متوسط Moderate'), (3, 'بسيط Minor')], verbose_name='تصنيف الحادث Classification of Incident')),
                ('equipment_vehicle_no', models.CharField(blank=True, max_length=50, null=True, verbose_name='رقم الآلية/العربة Equipment/Vehicle No')),
                ('client_contractor', models.CharField(blank=True, max_length=100, null=True, verbose_name='اسم الشركة/المتعاقد Client/Contractor')),
                ('date_time_occurred', models.DateTimeField(verbose_name='تاريخ وزمن وقوع الحادث Date & Time of Incident Occurred')),
                ('date_time_reported', models.DateTimeField(default=django.utils.timezone.now, verbose_name='تاريخ وزمن التبليغ عن الحادث Date & Time of Incident Report')),
                ('reported_to', models.CharField(max_length=100, verbose_name='إسم الشخص المْبلغ له Person Incident Reported to')),
                ('location', models.SmallIntegerField(choices=[(1, 'السفر ل/من العمل Travelling To/From Work'), (2, 'اثناء العمل On Duty'), (3, 'خارج مكان العمل(المعسكر مثلا) Off Duty (E.g. camp)')], verbose_name='مكان وقوع الحادث Incident Occurred at')),
                ('incident_description', models.TextField(verbose_name='وصف الحادث Description of the Incident')),
                ('injured_surname', models.CharField(blank=True, max_length=100, null=True, verbose_name='إسم المصاب Injured Surname')),
                ('injured_position', models.CharField(blank=True, max_length=100, null=True, verbose_name='الوظيفة Position')),
                ('injured_experience_years', models.PositiveIntegerField(blank=True, null=True, verbose_name=' الخبرة بالأعوام Experience in Years')),
                ('injured_date_of_birth', models.DateField(blank=True, null=True, verbose_name='تاريخ الميلاد Date of Birth')),
                ('injured_employment_basis', models.SmallIntegerField(blank=True, choices=[(1, 'دوام كامل Full Time'), (2, 'دوام جزئي Part Time'), (3, 'يومية Casual'), (4, 'متعاقد Contractor')], null=True, verbose_name='نوع التوظيف Basis of Employment')),
                ('lost_time_injury', models.BooleanField(default=False, verbose_name='هل تسببت الإصابة في التغيب عن العمل؟ Did this incident cause of Lost Time of working days?')),
                ('lost_days', models.PositiveIntegerField(blank=True, null=True, verbose_name='في حال كانت الإجابة نعم حدد عدد الأيام حتى تاريخ هذا التقرير If yes, specify Number of lost days up to this report')),
                ('ppe_gloves', models.BooleanField(default=False, verbose_name='قفازات Gloves')),
                ('ppe_helmet', models.BooleanField(default=False, verbose_name='خوذة Helmet')),
                ('ppe_safety_cloth', models.BooleanField(default=False, verbose_name='لبس السلامة Safety cloth')),
                ('ppe_safety_shoes', models.BooleanField(default=False, verbose_name='حذاء السلامة Safety Shoes')),
                ('ppe_face_protection', models.BooleanField(default=False, verbose_name='نظارة/واقي وجهGlass/face Protection')),
                ('ppe_ear_protection', models.BooleanField(default=False, verbose_name=' واقي الاذن Ear Protection')),
                ('ppe_mask', models.BooleanField(default=False, verbose_name='كمامة Mask')),
                ('ppe_other', models.CharField(blank=True, max_length=100, null=True, verbose_name='اخرى Other')),
                ('nature_of_injury', models.TextField(blank=True, null=True, verbose_name='طبيعة الاصابة او المرض ( مثلا تمزق ، كسر، جرح) Nature of Injury or Illness (e.g. fracture, strain/sprain, bruising)')),
                ('bodily_location', models.CharField(blank=True, max_length=100, null=True, verbose_name='مكان الاصابة بالجسم او المرض(مثلا اليد اليمنى، اسفل الظهر، الرئتين) Bodily Location of Injury or Illness (e.g. right leg, lower back)')),
                ('first_aid_details', models.TextField(blank=True, null=True, verbose_name='تفاصيل الاسعافات الاولية المقدمة للمصاب Details of Any First Aid Treatment Provided')),
                ('first_aider_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='اسم المسعف Name of First Aider')),
                ('hospital_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='في حالة تم نقله للمستشفى، اسم المستشفى If admitted to Hospital,hospital name')),
                ('property_description', models.CharField(blank=True, max_length=200, null=True, verbose_name='وصف للالية/الملكية المتضررة Description of Property/Equipment Damage')),
                ('damage_nature', models.TextField(blank=True, null=True, verbose_name='طبيعة الضرر للالية/الملكية Nature of Property/Equipment Damage')),
                ('material_spill_details', models.TextField(blank=True, null=True, verbose_name='تفاصيل كمية المواد المتسربة ونوعها Details of materials spill and quantities, its type')),
                ('control_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(0)], verbose_name="تكلفة الاليات/المركبات/الاشخاص المستخدمة في التحكم في الحادث Cost of Equipment's/vehicle’s/human’s used to control Incident")),
                ('total_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(0)], verbose_name='تكلفة الحادث Cost of the accident')),
                ('other_expenses', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(0)], verbose_name='اي مصاريف اخرى Other expenses')),
                ('currency', models.CharField(choices=[('sdg', 'sdg'), ('euro', 'euro'), ('dollar', 'dollar')], default='sdg', max_length=10, verbose_name='currency')),
                ('precise_location', models.TextField(verbose_name='تحديد موقع وقوع الحادث Precise location at which incident occurred')),
                ('precise_operation', models.TextField(verbose_name='وصف مختصر للعملية/المهمة اثناء وقوع الحادث Brief description of work in progress at time of incident')),
                ('site_closed_now', models.BooleanField(default=False, verbose_name='هل موقع العمل مغلق؟ Site closed now?')),
                ('site_closed_because_of_incident', models.BooleanField(default=False, verbose_name='تم الاغلاق نتيجة الحادث؟ Shutdown because of the incident?')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='hse_incidents_report', to='company_profile.tblcompanyproduction', verbose_name='company')),
                ('created_by', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='created_by')),
                ('updated_by', models.ForeignKey(editable=False, on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='updated_by')),
            ],
            options={
                'verbose_name': 'Incident',
                'verbose_name_plural': 'Incidents',
                'ordering': ['-date_time_occurred'],
            },
        ),
        migrations.AddField(
            model_name='incidentanalysis',
            name='incident',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='analysis', to='hse_companies.incidentinfo'),
        ),
        migrations.CreateModel(
            name='FactorsAssessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('related_documents_exist', models.BooleanField(default=False, verbose_name='هل يوجد وثائق تتعلق بالحادث؟ Were there any documents related to incident?')),
                ('related_documents_details', models.TextField(blank=True, help_text='Policies, instructions, working procedures, JSA, risk assessment, etc.', null=True, verbose_name='تفاصيل الوثائق documents details')),
                ('failed_controls', models.TextField(blank=True, help_text='From Risk Assessment, what were the failed or absent controls?', null=True, verbose_name='من تقييم درجة المخاطر، ماهي إجراء"ت" التحكم الغائبة او التي فشلت؟ From Risk Assessment, what was the failed or absent control’s?')),
                ('supervisor_present', models.BooleanField(default=False, verbose_name='هل كان يوجد مشرف وردية وقت وقوع الحادث؟ Was there a supervisor on shift at the time of incident?')),
                ('supervisor_presence_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('supervisor_hazard_competency', models.BooleanField(default=False, verbose_name='هل المشرف ذا كفاءة وقدرة لتمييز المخاطر بمكان العمل؟ Supervisor’s competency of workplace hazards?')),
                ('supervisor_hazard_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('supervisor_controls_competency', models.BooleanField(default=False, verbose_name='هل المشرف ذا كفاءة باجراءات التحكم؟ Supervisor’s competency in controls? (SOP & procedures)')),
                ('supervisor_controls_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('person_hazard_competency', models.BooleanField(default=False, verbose_name='هل الشخص المعني بالحادث ذا كفاءة لتمييز المخاطر بمكان العمل؟ Competency of workplace hazards?')),
                ('person_hazard_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('competency_in_controls', models.BooleanField(default=False, verbose_name='هل هو ذا كفاءة بإجراءات التحكم؟ Competency in controls? (SOP & procedures)')),
                ('competency_controls_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('correct_ppe_worn', models.BooleanField(default=False, verbose_name='هل كان يرتدي ادوات السلامة المناسبة للعملية؟ Was the correct PPE worn')),
                ('ppe_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('technical_competence', models.BooleanField(default=False, verbose_name='هل هو ذا كفاءة فنية لاداء المهمة؟ Was the person technically competent to do the task?')),
                ('technical_competence_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('fatigue_factor', models.BooleanField(default=False, verbose_name='هل لعب الارهاق دوراً في  الحادث؟ Did fatigue play a role in an incident?')),
                ('fatigue_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('substance_abuse_factor', models.BooleanField(default=False, verbose_name='هل لعب تناول الكحول/سوء استخدام العقاقير دوراً في الحادث؟ Did alcohol/substance abuse play a role in the incident?')),
                ('substance_abuse_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('correct_equipment_used', models.BooleanField(default=False, verbose_name='هل تم استخدام الالية المناسبة؟ Was the correct equipment used')),
                ('equipment_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('equipment_good_condition', models.BooleanField(default=False, verbose_name='هل كانت الآلية بحالة جيدة؟ Was the equipment in good condition')),
                ('equipment_condition_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('equipment_inspected', models.BooleanField(default=False, help_text='قائمة فحص قبل الاستخدام والفحص الشهري Pre-use checklist & Monthly inspection', verbose_name='هل تم فحص الآلية؟ Was the equipment inspected?')),
                ('equipment_inspection_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('risk_assessment_conducted', models.BooleanField(default=False, verbose_name='هل تم اجراء تقييم مخاطر قبل المهمة؟ Was a pre-task Risk Assessment conducted?')),
                ('risk_assessment_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('area_declared_safe', models.BooleanField(default=False, verbose_name='هل تم التصريح بان المنطقة امنة؟ او تم اصدار تصريح عمل؟ Was the area declared safe? Or was a permit to work issued?')),
                ('area_safety_reason', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('changes_after_declaration', models.BooleanField(default=False, verbose_name='هل حدثت اي تغييرات بعد التصريح بان المنطقة امنة/ماقبل المهمة/تصريح العمل حتى وقوع الحادث؟ Did any changes occur after the safe declaration/pre-task/PTW until incident?')),
                ('changes_details', models.TextField(blank=True, null=True, verbose_name='اعطي سبب give reason')),
                ('other_root_causes', models.TextField(blank=True, null=True, verbose_name='اي اسباب جذرية اخرى تتعلق بوقوع الحادث؟ Any other root causes?')),
                ('incident', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='factors_assessment', to='hse_companies.incidentinfo')),
            ],
        ),
        migrations.AddField(
            model_name='apphsecorrectiveaction',
            name='incident',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='hse_companies.incidentinfo', verbose_name='تقرير حادث Incident report'),
        ),
        migrations.CreateModel(
            name='IncidentPhoto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('photo', models.ImageField(upload_to=hse_companies.models.incidents.IncidentPhoto.company_applications_path, verbose_name='الصورة Photo')),
                ('description', models.TextField(blank=True, null=True, verbose_name='وصف الصورة photo description')),
                ('incident', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='incident_photos', to='hse_companies.incidentinfo')),
            ],
            options={
                'verbose_name': 'Photo',
                'verbose_name_plural': 'Photos',
            },
        ),
        migrations.CreateModel(
            name='IncidentWitness',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='إسم الشاهد Witness Name')),
                ('job_title', models.CharField(max_length=100, verbose_name='المهنة Job Title')),
                ('statement', models.TextField(verbose_name='إفادة الشاهد/Witness Statement')),
                ('incident', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='incident_witnesses', to='hse_companies.incidentinfo')),
            ],
            options={
                'verbose_name': 'إفادة الشاهد/Witness Statement',
                'verbose_name_plural': 'إفادة الشهود/Witness Statements',
            },
        ),
        migrations.CreateModel(
            name='LeasonLearnt',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('leason', models.TextField(verbose_name='الدروس المستفادة Lesson Learnt')),
                ('incident', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='leasons_learnt', to='hse_companies.incidentinfo')),
            ],
        ),
    ]
